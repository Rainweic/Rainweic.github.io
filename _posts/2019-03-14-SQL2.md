---
layout:     post
title:      "çœ‹ä¾‹å­å­¦SQL--SQLè¯­æ³•(2)"
subtitle:   "å•è¡¨ æŸ¥è¯¢&ç»Ÿè®¡"
date:       2019-03-12 22:00:00
author:     "Rainweic"
header-img: "img/sql_artical/SQL-2019-03-14.jpg"
tags:
    - SQL
---

# å•è¡¨æŸ¥è¯¢ä¸ç»Ÿè®¡
# TIP:
æœ¬èŠ‚ä¸­æ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹:
* as
* %
* _
* distinct
* count()
* group by
* avg()


#### ä»¥ä»¥ä¸‹è¡¨æ ¼ä¸ºä¾‹:
majorè¡¨:

| mno | mname |
| :-: | :-: |
| xx | xxxx |
| ... | ... |

stuè¡¨:

| sno | sname | ssex | sage | mno |
| :-: | :-: | :-: | :-: | :-: |
| xx | xxx | x | xx | xx |
| ... | ... | ... | ... | ... |

couè¡¨:

| cno | cname | ctime |
| :-: | :-: | :-: |
| xx | xxx | xx |
| ... | ... | ... |

scè¡¨:

| sno | cno | grade |
| :-: | :-: | :-: |
| xx | xx | xx |
| ... | ... | ... |


### å•è¡¨æŸ¥è¯¢
-------
æŸ¥è¯¢stuæ‰€æœ‰è®°å½•:
```
select * from stu
```
æŸ¥è¯¢stuè¡¨çš„å­¦å·ä¸å§“åä¸å¹´é¾„
```
select sno, sname, sage from stu
```
æŸ¥è¯¢æ‰€æœ‰å¥³ç”Ÿçš„å­¦å·ä¸å§“åä»¥åŠå¹´é¾„(ssexå€¼:0ç”·1å¥³)
```
select sno, sname, sage from stu where ssex=1
```
æŸ¥è¯¢å¹´é¾„åœ¨18-20ä¹‹é—´çš„å­¦ç”Ÿè®°å½•(ä¿©ç§å†™æ³•)
```
select * from stu where sage between 18 and 20
```
```
select * from stu where sage>=18 and sage<=20
```
æŸ¥è¯¢ä¸“ä¸šå·ä¸ºç©ºçš„å­¦ç”Ÿ
```
select * from stu where mno is null
```
æŸ¥è¯¢æ‰€æœ‰å§“é™ˆçš„å­¦ç”Ÿ
```
select * from stu where sname like 'é™ˆ%'
```
* æ³¨: %åŒ¹é…ä»»æ„å­—ç¬¦0æˆ–å¤šæ¬¡

æŸ¥è¯¢åå­—ç¬¬äºŒä¸ªä¸ºâ€˜ç²â€™çš„å­¦ç”Ÿ
```
select * from stu where sname like '__ç²%'
```
* æ³¨: _åŒ¹é…ä»»æ„å­—ç¬¦ä¸€æ¬¡ ä¸­æ–‡ä¸ºä¿©å­—ç¬¦æ•…ä¸º__

æŸ¥è¯¢ä¸“ä¸šå·ä¸º'01'ä¸'02'çš„å­¦ç”Ÿ
```
select * from stu where mno in('01','02')
```
æŸ¥è¯¢è¢«å­¦ç”Ÿé€‰æ‹©çš„è¯¾ç¨‹å·
```
select distinct cno from sc
```
* æ³¨: distinctå»é‡ å› ä¸ºscè¡¨ä¸­å¯èƒ½ä¸€ä¸ªè¯¾ç¨‹(cno)è¢«å¤šä½å­¦ç”Ÿ(sno)é€‰æ‹©.å¦‚ä¸‹è¡¨æƒ…å†µ:

    | sno | cno | grade |
    | :-: | :-: | :-: |
    | 01 | 01 | 98 |
    | 03 | 01 | 60 |
    | 02 | 02 | 80 |

    ä¸åŠ distinctä¼šå‡ºç°cnoå¤šæ¬¡å‡ºç°çš„æƒ…å†µ
    
æ³¨: ä»¥ä¸Šæ‰€æœ‰è¯­å¥ å¦å®šåªéœ€æ·»åŠ not

# å•è¡¨ç»Ÿè®¡
ç»Ÿè®¡é€‰ä¿®äº†è¯¾ç¨‹çš„å­¦ç”Ÿäººæ•°
```
select count(*) from stu
```
ç»Ÿè®¡æœ‰è¢«å­¦ç”Ÿé€‰ä¿®çš„è¯¾ç¨‹æ•°
```
select count(distinct cno) from sc
```
ç»Ÿè®¡æ¯ä¸ªä¸“ä¸šçš„å­¦ç”Ÿäººæ•°,å‡è®¾æ¯ä¸ªä¸“ä¸šéƒ½æœ‰å­¦ç”Ÿ
```
select mno, count(sno) from stu group by mno
```
* æ³¨:
    * æ€è·¯--ç»Ÿè®¡æ¯ä¸ªä¸“ä¸šçš„å­¦ç”Ÿäººæ•°,é‚£å°±æŒ‰ä¸“ä¸šåˆ†ç»„,ä¸€ä¸ªä¸“ä¸šä¸€ä¸ªç»„,å†åœ¨ç»„å†…è¿›è¡Œç»Ÿè®¡snoæ•°é‡(snoä¸ºä¸»é”®ä¸ä¼šé‡å¤)
    * group byä¸å¯ä¸whereè¯­å¥åœ¨ä¸€èµ·(è‹¥ä½¿ç”¨group byåˆéœ€è¦æ·»åŠ æ¡ä»¶ åˆ™ä½¿ç”¨having çœ‹ğŸ‘‡ä¾‹å­)
    
ç»Ÿè®¡äººæ•°è¶…è¿‡200çš„ä¸“ä¸šæ•°é‡
```
select mno, count(*) from stu group by mno having count(*)>200
```
* æ³¨: ç”¨havingå¯¹group byè¯­å¥æ·»åŠ é™åˆ¶æ¡ä»¶

ç»Ÿè®¡æ¯ä¸ªå­¦ç”Ÿçš„å¹³å‡åˆ†,è®¾æ¯ä¸ªå­¦ç”Ÿéƒ½æœ‰é€‰ä¿®è¯¾ç¨‹
```
select sno,avg(grade) as avg_grade from stu group by sno
```
* æ€è·¯: æ¯ä¸ªå­¦ç”Ÿ---å¯¹å­¦ç”Ÿè¿›è¡Œåˆ†ç»„ å†æ±‚å¾—å¹³å‡åˆ†å³å¯(avg(grade))
 
* select å­—æ®µ as åˆ«å åœ¨æ•°æ®åº“ä¸­è¯•è¯•è¯¥è¯­å¥å°±çŸ¥é“åˆ«åæŒ‡å•¥äº†~~~

ç»Ÿè®¡å¹³å‡åˆ†80åˆ†ä»¥ä¸Šçš„å­¦ç”Ÿçš„å¹³å‡æˆç»©
```
select sno, avg(grade) as avg_grade from sc group by sno having avg(grade)>80
```
ç»Ÿè®¡æ¯é—¨è¯¾çš„é€‰ä¿®äººæ•°,å‡è®¾æ¯é—¨è¯¾éƒ½æœ‰äººé€‰ä¿®
```
select cno,count(*) from sc group by cno
```
